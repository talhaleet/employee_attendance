<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>School Teacher Attendance System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <link rel="stylesheet" href="index.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="fas fa-chalkboard-teacher me-2"></i>
                Teacher Attendance System
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#" id="teachersTabBtn">
                            <i class="fas fa-users me-1"></i> Teachers
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" id="attendanceTabBtn">
                            <i class="fas fa-calendar-alt me-1"></i> Attendance
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" id="analyticsTabBtn">
                            <i class="fas fa-chart-pie me-1"></i> Analytics
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" id="settingsTabBtn">
                            <i class="fas fa-cog me-1"></i> Settings
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <!-- Main Content Tabs -->
        <div class="tab-content">
            <!-- Teachers Tab -->
            <div class="tab-pane fade show active" id="teachersTab">
                <div class="card card-pri">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <span><i class="fas fa-users me-2"></i>Teacher Management</span>
                        <button class="btn btn-light btn-sm" data-bs-toggle="modal" data-bs-target="#addTeacherModal">
                            <i class="fas fa-plus me-1"></i> Add Teacher
                        </button>
                    </div>
                    <div class="card-header ">
                        <div class="table-responsive">
                            <table class="table table-hover" id="teacherTable">
                                <thead >
                                    <tr >
                                        <th>ID</th>
                                        <th>Name</th>
                                        <th>Salary</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Teachers will be loaded here dynamically -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Attendance Tab -->
            <div class="tab-pane fade" id="attendanceTab">
                <div class="row mb-3">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <i class="fas fa-calendar me-2"></i>Select Month and Teacher
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="attendanceMonth" class="form-label">Month</label>
                                        <input type="month" class="form-control" id="attendanceMonth">
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="attendanceTeacher" class="form-label">Teacher</label>
                                        <select class="form-select" id="attendanceTeacher">
                                            <option value="">Select Teacher</option>
                                            <!-- Teachers will be loaded here dynamically -->
                                        </select>
                                    </div>
                                </div>
                                <button class="btn btn-primary" id="loadAttendanceBtn">
                                    <i class="fas fa-sync me-1"></i> Load Attendance
                                </button>
                                <button class="btn btn-secondary pdf-download-btn" id="downloadPdfBtn">
                                    <i class="fas fa-file-pdf me-1"></i> Download PDF
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <i class="fas fa-info-circle me-2"></i>Attendance Summary
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-4 text-center">
                                        <h5 class="text-success" id="presentDays">0</h5>
                                        <small>Present</small>
                                    </div>
                                    <div class="col-4 text-center">
                                        <h5 class="text-danger" id="absentDays">0</h5>
                                        <small>Absent</small>
                                    </div>
                                    <div class="col-4 text-center">
                                        <h5 class="text-warning" id="leaveDays">0</h5>
                                        <small>Leave</small>
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <h6>Salary Deduction: <span id="salaryDeduction">â‚¹0</span></h6>
                                    <div class="progress mt-2">
                                        <div class="progress-bar bg-danger" id="deductionProgress" role="progressbar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <span><i class="fas fa-calendar-check me-2"></i>Attendance Calendar</span>
                    </div>
                    <div class="card-body">
                        <div class="calendar-container" id="attendanceCalendar">
                            <div class="alert alert-info">
                                Please select a month and teacher to view attendance.
                            </div>
                        </div>
                        <div class="mt-3">
                            <div class="d-flex gap-2 flex-wrap">
                                <button class="btn btn-sm btn-success" id="markPresentBtn">
                                    <i class="fas fa-check"></i> Mark Present
                                </button>
                                <button class="btn btn-sm btn-danger" id="markAbsentBtn">
                                    <i class="fas fa-times"></i> Mark Absent
                                </button>
                                <button class="btn btn-sm btn-warning" id="markLeaveBtn">
                                    <i class="fas fa-umbrella-beach"></i> Mark Leave
                                </button>
                                <button class="btn btn-sm btn-outline-secondary" id="clearMarkingBtn">
                                    <i class="fas fa-eraser"></i> Clear
                                </button>
                            </div>
                            <div class="mt-2">
                                <small class="text-muted">Click on a day to select it, then choose an attendance status</small>
                            </div>
                            <div class="mt-3">
                                <div class="d-flex gap-2 flex-wrap">
                                    <span class="badge bg-success">Present</span>
                                    <span class="badge bg-danger">Absent</span>
                                    <span class="badge bg-warning text-dark">Leave</span>
                                    <span class="badge" style="background-color: var(--holiday-color); color: white;">Holiday</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Analytics Tab -->
            <div class="tab-pane fade" id="analyticsTab">
                <div class="row mb-3">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <i class="fas fa-filter me-2"></i>Filter Options
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="analyticsMonth" class="form-label">Month</label>
                                        <input type="month" class="form-control" id="analyticsMonth">
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="analyticsTeacher" class="form-label">Teacher (Optional)</label>
                                        <select class="form-select" id="analyticsTeacher">
                                            <option value="">All Teachers</option>
                                            <!-- Teachers will be loaded here dynamically -->
                                        </select>
                                    </div>
                                </div>
                                <button class="btn btn-primary" id="loadAnalyticsBtn">
                                    <i class="fas fa-chart-bar me-1"></i> Generate Report
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <i class="fas fa-info-circle me-2"></i>Overall Statistics
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-4 text-center">
                                        <h5 class="text-success" id="avgPresent">0%</h5>
                                        <small>Avg. Present</small>
                                    </div>
                                    <div class="col-4 text-center">
                                        <h5 class="text-danger" id="avgAbsent">0%</h5>
                                        <small>Avg. Absent</small>
                                    </div>
                                    <div class="col-4 text-center">
                                        <h5 class="text-warning" id="avgLeave">0%</h5>
                                        <small>Avg. Leave</small>
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <h6>Total Deductions: <span id="totalDeductions">â‚¹0</span></h6>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card mb-4">
                    <div class="card-header">
                        <i class="fas fa-chart-line me-2"></i>Attendance Trends
                    </div>
                    <div class="card-body">
                        <canvas id="attendanceChart" height="100"></canvas>
                    </div>
                </div>

                <div class="row" id="teacherAnalyticsContainer">
                    <!-- Teacher analytics cards will be loaded here dynamically -->
                </div>
            </div>

            <!-- Settings Tab -->
            <div class="tab-pane fade" id="settingsTab">
                <div class="row">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <i class="fas fa-money-bill-wave me-2"></i>Salary Deduction Settings
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label for="deductionAmount" class="form-label">Deduction per Absent Day (â‚¹)</label>
                                    <input type="number" class="form-control" id="deductionAmount" value="500">
                                </div>
                                <div class="mb-3">
                                    <label for="maxLeaves" class="form-label">Maximum Leaves Allowed Per Month</label>
                                    <input type="number" class="form-control" id="maxLeaves" value="1">
                                </div>
                                <button class="btn btn-primary" id="saveSettingsBtn">
                                    <i class="fas fa-save me-1"></i> Save Settings
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <i class="fas fa-calendar-times me-2"></i>Holiday Management
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label for="holidayDate" class="form-label">Add Holiday Date</label>
                                    <input type="date" class="form-control" id="holidayDate">
                                </div>
                                <div class="mb-3">
                                    <label for="holidayDescription" class="form-label">Holiday Description</label>
                                    <input type="text" class="form-control" id="holidayDescription" placeholder="Optional description">
                                </div>
                                <button class="btn btn-primary mb-3" id="addHolidayBtn">
                                    <i class="fas fa-plus me-1"></i> Add Holiday
                                </button>
                                
                                <h6>Current Holidays</h6>
                                <div class="holiday-list" id="holidayList">
                                    <!-- Holidays will be listed here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <i class="fas fa-database me-2"></i>Data Management
                            </div>
                            <div class="card-body">
                                <div class="d-grid gap-2">
                                    <button class="btn btn-outline-primary" id="exportDataBtn">
                                        <i class="fas fa-file-export me-1"></i> Export Data
                                    </button>
                                    <input type="file" id="importFileInput" accept=".json" style="display: none;">
                                    <button class="btn btn-outline-secondary" id="importDataBtn">
                                        <i class="fas fa-file-import me-1"></i> Import Data
                                    </button>
                                    <button class="btn btn-outline-danger" id="resetDataBtn" data-bs-toggle="modal" data-bs-target="#resetDataModal">
                                        <i class="fas fa-trash-alt me-1"></i> Reset All Data
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Teacher Modal -->
    <div class="modal fade" id="addTeacherModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add New Teacher</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="addTeacherForm">
                        <div class="mb-3">
                            <label for="teacherName" class="form-label">Teacher Name</label>
                            <input type="text" class="form-control" id="teacherName" required>
                        </div>
                        <div class="mb-3">
                            <label for="teacherSalary" class="form-label">Monthly Salary (â‚¹)</label>
                            <input type="number" class="form-control" id="teacherSalary" required min="0">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="saveTeacherBtn">Save Teacher</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Teacher Modal -->
    <div class="modal fade" id="editTeacherModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Edit Teacher</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editTeacherForm">
                        <input type="hidden" id="editTeacherId">
                        <div class="mb-3">
                            <label for="editTeacherName" class="form-label">Teacher Name</label>
                            <input type="text" class="form-control" id="editTeacherName" required>
                        </div>
                        <div class="mb-3">
                            <label for="editTeacherSalary" class="form-label">Monthly Salary (â‚¹)</label>
                            <input type="number" class="form-control" id="editTeacherSalary" required min="0">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="updateTeacherBtn">Update Teacher</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Reset Data Confirmation Modal -->
    <div class="modal fade" id="resetDataModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title">Confirm Data Reset</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>Are you sure you want to reset all data? This action cannot be undone.</p>
                    <p class="text-danger"><strong>Warning:</strong> All teachers, attendance records, and settings will be permanently deleted.</p>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="confirmResetCheck">
                        <label class="form-check-label" for="confirmResetCheck">
                            I understand this action cannot be undone
                        </label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-danger" id="confirmResetBtn" disabled>Reset All Data</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="index.js"></script>
    </body>
</html>